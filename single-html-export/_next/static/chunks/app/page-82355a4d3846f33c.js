(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{67:function(){},2061:function(){},4354:function(e,t,s){Promise.resolve().then(s.bind(s,912)),Promise.resolve().then(s.bind(s,1481)),Promise.resolve().then(s.bind(s,9437)),Promise.resolve().then(s.bind(s,3914)),Promise.resolve().then(s.bind(s,3762)),Promise.resolve().then(s.bind(s,6964)),Promise.resolve().then(s.bind(s,8896)),Promise.resolve().then(s.bind(s,9060))},9437:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(7437),n=s(2265),l=s(1942);s(1146);var i=()=>{let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=()=>{let{scrollHeight:e,clientHeight:s}=document.documentElement,a=window.scrollY>10;t(e>s&&a)};return window.addEventListener("scroll",e),e(),()=>window.removeEventListener("scroll",e)},[]),(0,a.jsx)("div",{className:"download-button ".concat(e?"short":"long"),children:(0,a.jsx)("a",{href:"/EPM Tools - v".concat("0.6.15",".html"),download:!0,children:(0,a.jsxs)("button",{"aria-label":"Download Offline Version",children:[(0,a.jsx)("span",{className:"bg"}),(0,a.jsx)("span",{className:"blob"}),(0,a.jsx)(l.aBF,{}),(0,a.jsx)("span",{className:"caption",children:"Download Offline Version"})]})})})}},3914:function(e,t,s){"use strict";var a=s(7437),n=s(2265),l=s(2781),i=s(7800),r=s(3872),c=s(1942),o=s(8196),d=s(6748),u=s(4673),h=s.n(u);s(253),t.default=function(){let[,e]=(0,n.useState)(null),[t,s]=(0,n.useState)(""),[u,x]=(0,n.useState)([]),[p,m]=(0,n.useState)(!1),[j,b]=(0,n.useState)(""),[f,N]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),[S,y]=(0,n.useState)(!0),k=(0,n.useCallback)(e=>{let t=e[0];t&&(s(t.name),M(t))},[]),{getRootProps:w,getInputProps:C,isDragActive:D}=(0,l.uI)({onDrop:k,accept:".xlsx"}),M=e=>{let t=new FileReader;t.onload=e=>{let t=new Uint8Array(e.target.result),s=i.ij(t,{type:"array"}),a=s.SheetNames[0],n=s.Sheets[a];E(i.P6.sheet_to_json(n,{header:1,range:"A1:D32"}))},t.readAsArrayBuffer(e)};(0,n.useEffect)(()=>{u.length>0&&x(u.map(e=>{if(e.duration&&"NaN:NaN"!==e.duration){let t=(0,d.o6)(e.startTime,e.endTime);return S&&(t=R(t)),{...e,duration:t}}return e}))},[S]);let E=e=>{let t=[],s=h()().startOf("day");if(e.length>1){let t=e[1][0],s=h()(t,"jYYYY/jMM/jDD");b(new Intl.DateTimeFormat("fa-IR-u-nu-latn",{month:"short",year:"numeric"}).format(s))}e.forEach((e,a)=>{if(0===a)return;let n=e[0],l=e[1],i=e[2],r=e[3],c=(0,d.gA)(n),o=h()(c,"YYYY-MM-DD"),u=null,x="";o.isSame(s,"day")?x="امروز":o.isAfter(s,"day")?x="...":" "===i&&" "===r?x=" - ":" "===i?x="زمان ورود ثبت نشده":" "===r?x="زمان خروج ثبت نشده":(u=(0,d.o6)(i,r),S&&(u=R(u))),t.push({date:n,dayOfWeek:l,duration:u,status:x,startTime:i,endTime:r})}),x(t)},Y=()=>{let e=0;u.forEach(t=>{if(t.duration&&"NaN:NaN"!==t.duration){var s,a;let[n,l]=null!==(a=null===(s=t.duration)||void 0===s?void 0:s.split(":").map(Number))&&void 0!==a?a:"";e+=60*n+l}});let t=Math.floor(e/60),s=e%60;return"".concat(t.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"))},R=e=>{var t;let[s,a]=null!==(t=null==e?void 0:e.split(":").map(Number))&&void 0!==t?t:"",n=60*s+a,l=n<=510?Math.round(.0883*n):45,i=Math.floor((n-=l)/60),r=n%60;return"".concat(i.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))};return(0,a.jsxs)("div",{className:"section",children:[(0,a.jsxs)("h3",{onClick:()=>{N(!f)},className:"collapsible-header",children:[(0,a.jsx)(r.ugd,{})," Monthly Report"," ",(0,a.jsx)("span",{className:"rotate-icon ".concat(f?"rotated":""),children:(0,a.jsx)(c.RiI,{})})]}),(0,a.jsxs)("div",{className:"collapsible-content ".concat(f?"expanded":"collapsed"),children:[(0,a.jsxs)("div",{...w({className:"dropzone"}),children:[(0,a.jsx)("input",{...C()}),D?(0,a.jsx)("p",{children:"Drop the files here..."}):(0,a.jsx)("p",{children:"Drop .xlsx report, or click to select"}),t&&(0,a.jsxs)("b",{children:["Selected file: ",t]})]}),(0,a.jsxs)("div",{className:"hint-section",children:[(0,a.jsxs)("h5",{onClick:()=>{v(!g)},className:"collapsible-header",style:{fontSize:"0.9rem",opacity:"0.8"},children:[(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Zlu,{})," Where to get the report?"," "]}),g?(0,a.jsx)(c.s$2,{}):(0,a.jsx)(c.RiI,{})]}),(0,a.jsxs)("div",{className:"collapsible-content ".concat(g?"expanded":"collapsed"),children:[(0,a.jsx)("div",{style:{direction:"rtl",fontSize:"12px"},children:"گزارش ماهانه را از پنل حضور و غیاب دریافت کنید."}),(0,a.jsx)("br",{}),(0,a.jsx)("img",{src:"/export.png",alt:"Export hint",className:"export-hint-image"})]})]}),(0,a.jsxs)("span",{className:"button-row",children:[(0,a.jsxs)("button",{className:"primary-button",onClick:()=>{m(!0)},disabled:!u.length,children:["Generate Report ",(0,a.jsx)(c.Z1Y,{})]}),(0,a.jsxs)("button",{className:"secondary-button",onClick:()=>{e(null),s(""),x([]),m(!1)},children:[(0,a.jsx)(o.oAZ,{className:"reset-icon"})," Reset"]})]}),u.length>0&&(0,a.jsxs)("div",{className:"result ".concat(p?"calculated":""),children:[(0,a.jsxs)("table",{children:[(0,a.jsxs)("caption",{children:[(0,a.jsxs)("b",{children:["گزارش عملکرد ",j]}),(0,a.jsx)("br",{}),(0,a.jsx)("div",{className:"toggle-break-time",children:(0,a.jsxs)("label",{children:[(0,a.jsx)("small",{children:" کل زمان حضور"}),(0,a.jsx)("input",{type:"checkbox",checked:S,onChange:()=>y(!S)}),(0,a.jsx)("small",{children:" با کسر استراحت"})]})})," "]}),(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"تاریخ"}),(0,a.jsx)("th",{children:"روز"}),(0,a.jsx)("th",{children:"مدت"}),(0,a.jsx)("th",{children:"مدت اعشاری"})]})}),(0,a.jsxs)("tbody",{children:[u.map((e,t)=>{let s=!e.duration||"NaN:NaN"===e.duration;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.date}),(0,a.jsx)("td",{children:e.dayOfWeek}),s?(0,a.jsx)("td",{colSpan:"2",children:e.status}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("td",{className:"duration-cell",children:(0,a.jsx)("span",{className:S?"slide-exit":"slide-enter",children:e.duration},e.duration)}),(0,a.jsx)("td",{className:"duration-cell",children:(0,a.jsx)("span",{className:S?"slide-exit":"slide-enter",children:(0,a.jsx)("b",{children:(0,d.A5)(e.duration)})},(0,d.A5)(e.duration))})]})]},t)}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{colSpan:"2",children:(0,a.jsx)("b",{children:"مجموع ماه"})}),(0,a.jsx)("td",{className:"duration-cell",children:(0,a.jsx)("span",{children:Y()},Y())}),(0,a.jsx)("td",{className:"duration-cell",children:(0,a.jsx)("span",{children:(0,a.jsx)("b",{children:(0,d.A5)(Y())})},(0,d.A5)(Y()))})]})]})]}),(0,a.jsx)("span",{className:"button-row",children:(0,a.jsxs)("button",{className:"primary-button",onClick:()=>{let e=[["تاریخ","روز","مدت","مدت اعشاری"],...u.map(e=>[e.date,e.dayOfWeek,e.duration||e.status,e.duration?(0,d.A5)(e.duration):""]),["مجموع ماه","",Y(),(0,d.A5)(Y())]],t=i.P6.aoa_to_sheet(e),s=i.P6.book_new();i.P6.book_append_sheet(s,t,"Report"),i.NC(s,"گزارش ".concat(j,".xlsx"))},disabled:!u.length,children:["دریافت گزارش ",(0,a.jsx)(c.aBF,{})]})})]})]})]})}},3762:function(e,t,s){"use strict";s.r(t);var a=s(7437),n=s(2265);s(1927),t.default=()=>{let[e,t]=(0,n.useState)(),[s,l]=(0,n.useState)(!1),[i,r]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{h()},[]),(0,n.useEffect)(()=>{if(!localStorage.getItem("secondPopoverShown")){let e=setTimeout(()=>{i||u(!0)},1e4);return()=>clearTimeout(e)}},[i]);let h=async()=>{try{let e=await fetch("/api/banana-count");if(!e.ok)throw Error("Network response was not ok");let s=await e.json();t(s.count)}catch(e){console.error("Error fetching banana count:",e),t(fallbackBananaCount)}},x=async()=>{l(!0);try{let e=await fetch("/api/increment-banana",{method:"POST"});if(!e.ok)throw Error("Network response was not ok");let s=await e.json();t(s.count)}catch(e){console.error("Error incrementing banana count:",e)}finally{l(!1)}};return(0,a.jsx)("div",{className:"banana-button-section",children:i?(0,a.jsxs)("div",{className:"reveal-animation",children:[(0,a.jsx)("button",{onClick:x,className:"banana-button",style:{width:"200px"},disabled:s,children:(0,a.jsx)("span",{className:"take-a-banana",children:"Take a \uD83C\uDF4C "})}),(0,a.jsx)("span",{className:"bananaCount ".concat(void 0!==e?"slide-down":""),children:void 0!==e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("b",{children:e})," ",(0,a.jsx)("span",{children:"bananas have been taken "})]}):(0,a.jsx)("span",{className:"skeleton-loader",style:{width:"200px",height:"20px"}})})]}):(0,a.jsxs)("div",{className:"three-dots",onClick:()=>{r(!0),u(!1),localStorage.setItem("secondPopoverShown","true")},onMouseEnter:()=>{o(!0),u(!1)},onMouseLeave:()=>{o(!1)},children:[(0,a.jsx)("span",{className:"dot",children:"•"}),(0,a.jsx)("span",{className:"dot",children:"•"}),(0,a.jsx)("span",{className:"dot",children:"•"}),c&&(0,a.jsx)("div",{className:"popover slide-up",children:"You've found the secret!"})," ",d&&(0,a.jsx)("div",{className:"second-popover slide-up",children:"** pssssssst! ** Over here!"})," "]})})}},6964:function(e,t,s){"use strict";s.d(t,{default:function(){return d}});var a=s(7437),n=s(2265),l=s(1942),i=s(3051),r=s(8196),c=s(6748);let o=e=>{let{totalDuration:t,distributionPercentage:s}=e,n=s/100*8,l=Math.ceil(t/n),i=[];for(let e=1;e<=l;e++){let r=(e===l?t-(l-1)*n:n)/8*100;i.push((0,a.jsxs)("div",{style:{width:"20px",height:"20px",border:"1px solid black",position:"relative",display:"inline-block",margin:"2px",borderRadius:"3px",overflow:"hidden",textAlign:"center",lineHeight:"20px",color:"white",textShadow:"0px 0px 5px black",fontSize:"10px",fontWeight:"bolder"},children:[(0,a.jsx)("div",{style:{position:"absolute",zIndex:2,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:e}),(0,a.jsx)("div",{style:{borderTop:s<100?"1px solid #396881":"",position:"absolute",bottom:0,left:0,right:0,height:"".concat(s,"%"),width:"100%",zIndex:1}}),(0,a.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.16)",position:"absolute",bottom:0,left:0,right:0,height:"".concat(Math.min(r,s),"%"),width:"100%",zIndex:1}})]},e))}return(0,a.jsx)("div",{children:i})};var d=function(){let[e,t]=(0,n.useState)(""),[s,d]=(0,n.useState)(100),[u,h]=(0,n.useState)(""),[x,p]=(0,n.useState)(!1),[m,j]=(0,n.useState)(!1),b=(0,n.useCallback)(()=>{if(e&&s){let t=(0,c.ge)(parseFloat(e),parseFloat(s));p(!0),h(t)}},[s,e]);return(0,n.useEffect)(()=>{s>100&&d(100),s<0&&d(0)},[s]),(0,n.useEffect)(()=>{e<0&&t(0)},[e]),(0,n.useEffect)(()=>{b(),p(x)},[e,s,b,x]),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsxs)("h3",{onClick:()=>{j(!m)},className:"collapsible-header",children:[(0,a.jsx)(i.ZDe,{})," Task Distribution"," ",(0,a.jsx)("span",{className:"rotate-icon ".concat(m?"rotated":""),children:(0,a.jsx)(l.RiI,{})})," "]}),(0,a.jsxs)("div",{className:"collapsible-content ".concat(m?"expanded":"collapsed"),children:[(0,a.jsxs)("label",{className:"row",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)(l.fSQ,{style:{marginRight:"5px"}}),"Duration (Hours):"]}),(0,a.jsx)("input",{type:"number",value:e,onChange:e=>{t(Math.max(0,parseFloat(e.target.value)))},placeholder:"00",defaultValue:"0"})]}),(0,a.jsxs)("label",{className:"row",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)(i.iZP,{style:{marginRight:"5px"}}),"Distribution (%):"]}),(0,a.jsx)("input",{type:"number",value:s,onChange:e=>{d(Math.max(0,Math.min(100,parseFloat(e.target.value))))},placeholder:"100",defaultValue:"100"})]}),(0,a.jsxs)("span",{className:"button-row",children:[(0,a.jsxs)("button",{className:"primary-button",onClick:b,children:["Get Distribution ",(0,a.jsx)(l.Z1Y,{})]}),(0,a.jsxs)("button",{className:"secondary-button",onClick:()=>{h(""),d(100),t(""),p(!1)},children:[(0,a.jsx)(r.oAZ,{className:"reset-icon"})," Reset"]})]}),(0,a.jsxs)("div",{className:"result ".concat(x&&"calculated"),children:[(0,a.jsxs)("p",{children:["Span of days:"," ",(0,a.jsxs)("span",{className:"calculated-digits",style:{width:u?"50px":"0px",transition:"all 0.3s ease",display:"inline-block"},children:[" ",u," "]})]}),x&&(0,a.jsx)(o,{totalDuration:parseFloat(e),distributionPercentage:parseFloat(s)})]})]})]})}},8896:function(e,t,s){"use strict";var a=s(7437),n=s(2265),l=s(6356),i=s(1942),r=s(8196),c=s(6748),o=s(3051);t.default=function(){let[e,t]=(0,n.useState)("08:00"),[s,d]=(0,n.useState)("17:00"),[u,h]=(0,n.useState)("00:45"),[x,p]=(0,n.useState)(""),[m,j]=(0,n.useState)(""),[b,f]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{(()=>{if(e&&s){let t=(0,c.mr)(e),a=(0,c.mr)(s)-t;a<=510?h((0,c.LQ)(Math.round(.0883*a))):h((0,c.LQ)(45))}})()},[e,s]),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsxs)("h3",{onClick:()=>{f(!b)},className:"collapsible-header",children:[(0,a.jsx)(o.Hid,{})," Time Duration"," ",(0,a.jsx)("span",{className:"rotate-icon ".concat(b?"rotated":""),children:(0,a.jsx)(i.RiI,{})})," "]}),(0,a.jsxs)("div",{className:"collapsible-content ".concat(b?"expanded":"collapsed"),children:[(0,a.jsxs)("label",{className:"row",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)(l.qP7,{style:{marginRight:"5px"}})," Start Time:"]}),(0,a.jsx)("input",{type:"time",value:e,defaultValue:"08:00",onChange:e=>t(e.target.value)})]}),(0,a.jsxs)("label",{className:"row",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)(l.qP7,{style:{marginRight:"5px",transform:"rotate(180deg)"}})," ","End Time:"]}),(0,a.jsx)("input",{type:"time",value:s,defaultValue:"17:00",onChange:e=>d(e.target.value)})]}),(0,a.jsxs)("label",{className:"row",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)(l.K68,{style:{marginRight:"5px"}})," Break Time:"]}),(0,a.jsx)("input",{type:"text",value:u,onChange:e=>{let t=e.target.value.replace(/[^0-9]/g,"");t.length>4&&(t=t.substring(0,4)),4!==t.length||t.includes(":")||(t=t.slice(0,2)+":"+t.slice(2)),h(t)},placeholder:"00:00"})]}),(0,a.jsxs)("span",{className:"button-row",children:[(0,a.jsxs)("button",{className:"primary-button",onClick:()=>{if(e&&s&&u.match(/^\d{2}:\d{2}$/)){let t=(0,c.mr)(e),a=Math.abs((0,c.mr)(s)-t)-(0,c.mr)(u),n=Math.floor(a/60),l=a%60;p("".concat(n,":").concat(l.toString().padStart(2,"0"))),j((n+l/60).toFixed(2)),u||h("".concat(Math.round(.9883*a/60).toString().padStart(2,"0"),":00"))}},children:["Calculate Duration ",(0,a.jsx)(i.Z1Y,{})]}),(0,a.jsxs)("button",{className:"secondary-button",onClick:()=>{t("08:00"),d("17:00"),p(""),j(""),h("00:45")},children:[(0,a.jsx)(r.oAZ,{className:"reset-icon"})," Reset"]})]}),(0,a.jsxs)("div",{className:"result ".concat(x&&"calculated"),children:[(0,a.jsxs)("p",{children:["Duration:"," ",(0,a.jsxs)("span",{className:"calculated-digits",style:{width:x?"50px":"0px",transition:"all 0.3s ease",display:"inline-block"},children:[x," "]})]}),(0,a.jsxs)("p",{children:["Decimal Duration:"," ",(0,a.jsxs)("span",{className:"calculated-digits",style:{width:m?"50px":"0px",transition:"all 0.3s ease",display:"inline-block"},children:[m," "]})," "]})]})]})]})}},9060:function(e,t,s){"use strict";var a=s(7437),n=s(2265),l=s(1942),i=s(8196),r=s(3872);t.default=function(){let[e,t]=(0,n.useState)(""),[s,c]=(0,n.useState)(""),[o,d]=(0,n.useState)(!1);return(0,a.jsxs)("div",{className:"section",children:[(0,a.jsxs)("h3",{onClick:()=>{d(!o)},className:"collapsible-header",children:[(0,a.jsx)(r.Nck,{})," HH:mm to Decimal"," ",(0,a.jsx)("span",{className:"rotate-icon ".concat(o?"rotated":""),children:(0,a.jsx)(l.RiI,{})})," "]}),(0,a.jsxs)("div",{className:"collapsible-content ".concat(o?"expanded":"collapsed"),children:[(0,a.jsxs)("label",{className:"row",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)(l.fSQ,{style:{marginRight:"5px"}}),"Input HH:mm"]}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{let s=e.target.value.replace(/[^0-9]/g,"");s.length>4&&(s=s.substring(0,4)),4!==s.length||s.includes(":")||(s=s.slice(0,2)+":"+s.slice(2)),t(s)},placeholder:"00:00",defaultValue:"00:00"})]}),(0,a.jsxs)("span",{className:"button-row",children:[(0,a.jsxs)("button",{className:"primary-button",onClick:()=>{if(e.match(/^\d{2}:\d{2}$/)){let[t,s]=null==e?void 0:e.split(":").map(Number);c((t+s/60).toFixed(2))}},children:["Convert to Decimal",(0,a.jsx)(l.Z1Y,{})]}),(0,a.jsxs)("button",{className:"secondary-button",onClick:()=>{t(""),c("")},children:[(0,a.jsx)(i.oAZ,{className:"reset-icon"})," Reset"]})]}),(0,a.jsxs)("div",{className:"result ".concat(s&&"calculated"),children:[(0,a.jsxs)("p",{children:["Decimal Time:"," ",(0,a.jsxs)("span",{className:"calculated-digits",style:{width:s?"50px":"0px",transition:"all 0.3s ease",display:"inline-block"},children:[" ",s," "]})]})," "]})]})]})}},1146:function(){},253:function(){},1927:function(){},6748:function(e,t,s){"use strict";s.d(t,{A5:function(){return o},LQ:function(){return l},gA:function(){return c},ge:function(){return i},mr:function(){return n},o6:function(){return r}});var a=s(4673);let n=e=>{let[t,s]=null==e?void 0:e.split(":").map(Number);return 60*t+s},l=e=>{let t=Math.floor(e/60).toString().padStart(2,"0"),s=(e%60).toString().padStart(2,"0");return"".concat(t,":").concat(s)},i=(e,t)=>Math.ceil(e/((t=Math.max(0,Math.min(100,t)))/100*8)),r=(e,t)=>{if(e&&t){let s=n(e),a=n(t)-s;return"".concat(Math.floor(a/60),":").concat((a%60).toString().padStart(2,"0"))}},c=e=>a(e,"jYYYY/jMM/jDD").format("YYYY-MM-DD"),o=e=>{if(e.match(/^\d{1,3}:\d{2}$/)){let[t,s]=null==e?void 0:e.split(":").map(Number);return Number((t+s/60).toFixed(2))}}}},function(e){e.O(0,[456,425,522,51,699,240,614,990,275,971,23,744],function(){return e(e.s=4354)}),_N_E=e.O()}]);